//Abstract
This paper presents a novel single-control-circuit multiple-output digital low dropout regulator (DLDO). Operating in the time division multiplexing mode, this DLDO can share a single control circuit and regulate multiple outputs at different time period. With the proposed delay switching technique, the cross regulation between different outputs can be totally eliminated. A prototype with two outputs was fabricated with UMC 130nm process and this approach can be extended to more outputs theoretically. As the DLDO design becomes more and more complicate and the control circuit takes up more and more area, this design points out a very promising way to save the total chip area.

This paper presents a single-inductor multiple- output (SIMO) converter operating in pseudo-continuous con- duction mode (PCCM) and/or discontinuous conduction mode (DCM). With the proposed freewheel switching control, this con- verter can handle large load currents with a much smaller current ripple, while retaining low cross regulation. It can also work in DCM for high efficiency at light loads. A prototype of a single- inductor dual-output (SIDO) boost converter was fabricated with a standard 0.5- m CMOS n-well process. The two outputs are regulated at 2.5 and 3.0 V, respectively. At an oscillator frequency of 1 MHz, the efficiency reaches 89.4% at a total output power of 320 mW. Compared with prior designs, both current and voltage ripples are reduced. This design can be extended to have multiple outputs and for different types of dc–dc conversions, or be applied to single-output converters for fast transient response.


// Micro Ring Modulator
In the burgeoning integrated optoelectronics design, the silicon Micro Ring Modulator (MRM) is believed to be the most important device to realize optical interconnect, which have been proposed to displace electrical interconnects as the next generation I/O links due to its ultra-wide bandwidth and low loss advantages \cite{wangzhicheng}. However, as is highly sensitive to the thermal fluctuation, the MRM usually requires a feedback control circuit to stabilize its resonant wavelength. Normally, the control circuit is much larger than the micro ring, and in order to save chip area, \cite{wangzhicheng} have proposed a TDM scheme to simultaneous lock the wavelength of multiple silicon micro rings. 
Fig.\ref{MRM} shows the working principle of the TDM scheme. The MUX and DEMUX connect the photodetector(PD) and its corresponding supply modulator to the controller at different time intervals, as a result, the shared controller, which is composed of an ADC, a MCU and a DAC, can cope with different micro rings simultaneously.

//Introduction sentences for the TDM scheme
In some circuit designs, a certain building block takes up a great percentage of the whole chip area. Instances are like the controller in the micro ring modulator, the inductor in the DC-DC converter, and the compensation capacitor in the low dropout regulator (LDO). Normally, more than one such circuits are needed in a SoC circuit, and the most straightforward way to realize it is to implement N single output such circuits. However, one the one hand, this immoderately consumes the chip area, and on the other hand, passive devices like inductor and capacitor may bring about great noise to the circuit. To solve this problem, the TDM scheme has been applied to many circuit and have achieved great success.

//Last paragraph in Introduction
In the following parts of this paper, we will first discuss the TDM scheme applied in many circuit designs in section II, then in section III, we will talk about the architecture and working principles of the proposed design. In section IV, the implementation and design considerations of the circuit will be discussed. In section V, we present the experiment results of the proposed design, and finally we draw a conclusion in section VI.

![](/Users/leafopenxuan 1/Desktop/DCDC-timing.pdf)
![](/Users/leafopenxuan 1/Desktop/DCDC.pdf)

The DC-DC converters are usually applied in the SoC power management circuit for its high converting efficiency. However an off-chip inductor is required for every DC-DC converter. When multiple power domains exists, which is quite normal in a SoC circuit, multiple DC-DC converters are implemented conventionally. This not only increase the number of required on-chip pads, but also may bring about great noise to the circuit. In \cite[] an single inductor multiple output (SIMO) DC-DC buck converter is proposed, as is shown in Fig\ref{fig:DCDC}.

Both subconverter a and converter b are operating in DCM mode, and Fig\ref{fig:DCDC-timing} explicitly interprets the working principle. $\Phi a$ and $\Phi b$ are two complementary phase signals which indicate the regulating period. When $\Phi a = 1$, the subconverter A is connected to the inductor, and the current through the inductor ramps up at $D_{1a}T$ and ramp down at $D_{2a}T$. Similar current behavior happens again when $\Phi b =1$, and the current is assigned to different subconverters without affecting each other.

//the proposed TDM DLDO
Contrary to the analog counterpart, in the Digital LDO design, the control circuit takes up a great percentage of the whole chip area, even greater than the power stage. The control circuit is usually composed of shift registers, and each power MOS array unit needs a shift register stage. So it would be very promising if we can share the control circuit between different outputs like the TDM MRMs and the SIMO DC-DC converters.

	Fig.\ref{fig:TDMDLDO} shows our proposed TDM DLDO, and the working principle is very simple and similar to the TDM MRM. The mux select different outputs to the comparator at certain time periods. Then the comparator compares the output voltages with the reference, and the comparison result serves as the input signal of the controller, which finally determines the states of the power PMOS array. Multiple outputs share the single control circuit at different time period, so the proposed DLDO is operating at TDM mode.

//architecture

![](/Users/leafopenxuan 1/Desktop/schemetic/sche.pdf)  
![](/Users/leafopenxuan 1/Desktop/flowChart.pdf)
![](/Users/leafopenxuan 1/Desktop/timing.pdf)

The architecture of the proposed TDM DLDO is shown in Fig.\ref{fig:TDMDLDO}. It mainly composes of a comparator, a output MUX, an analog-assisted loop, two groups of latches, namely lat\_0 and lat\_1 in the diagram, two groups of PMOS arrays, in each group the size of the "coarse" PMOS array unit is 9 times larger than that of the "fine" PMOS array unit, and two groups of shift register, which are coarse and fine shift registers. The shift registers determine the states of the PMOS arrays and can be asynchronously set/reset by the special set/reset block.  

In the whole diagram, not only the comparator, but also the analog-assisted loop and the coarse and fine shift registers are shared the by two outputs. The latches serve as the buffer stage, which also exist in many other DLDO designs\cite{}. Apart from that, only an additional multiplexer, the "outputMux" is added to the circuit, which scarcely bring any additional area to the whole chip. In other word, we almost double the efficiency of the control circuit in terms of area.

In the TDM scheme design, cross coupling is one of the most salient problems. In the SIMO DC-DC converter proposed in \cite{}, the subconverters work in DCM mode, so there is a inherit guard period  between different regulating periods when the current running through the inductor stays zero. And in the TDM micro ring proposed in\cite{wangzhicheng}, a guard period is also inserted between different processing periods to avoid the cross coupling between different outputs. In DLDO, the PMOS arrays are controlled by the shift registers. If we share the shift registers without protection, the states of other PMOS array may be loaded during the switching period and great cross-channel coupling occurs. To solve this problem, we propose the delay switching technique.

Fig.\ref{fig:} is the timing diagram of our design, "clk" is the system clock and "path" is the path switching signal. The "sele" signal generates a pulse at every rising and falling edges of the "path". And "P0/1SeleClk" are the derivative signal from "path" and "sele", which drives the latch groups. “D0/1” stands for the states of the PMOS array, and “D” stands for the outputs of the shift register. 

The working principle of the delay switching technique is best interpreted with the reference of the flowchart shown in Fig.\ref{fig:flowchart}. At every switching instance, the "sele" signal generates a pulse, in other word, "sele" = 1 during this period. If "path" = 1 at that time, meaning that the control circuit is to be connected to the power PMOS array 1, then the power PMOS array 0 is latched by "lat\_0", so the output voltage at path 0 maintains if the load does not change. Meanwhile, the asynchronous set/reset block load the previously latched states of the array 1 to the shift registers. After all the data are loaded and the pulse at "sele" signal disappears, then the power PMOS array 1 is officially connected to the shift registers. And the shift registers starts to control the states of the power PMOS array according to the comparison results until the next switching instance happens. As we load its previous states before we connect one path to the control circuit, no cross-channel coupling should exist.

As is shown in Fig.\ref{fig:aaloop}, the unit in (a) remains high when the undershoot appear, that is because the state of the PMOS could only change at every clock rising edge, inherent drawback of the DLDO design. So we add a RC coupling aa loop between the output and the buffer. When load changes, it can sense the output undershoot transfer it to the PMOS array instantly.

When the load switch from light to heavy, the power PMOS array may not able to provide enough current, and an undershoot occurs at the output. Normally, the shift register should turn on the array units to provide more current. However, as is shown in Fig.\ref{fig:aaloop}a, the array unit remains high until the clock arrives and the shift register transfer the comparison result to the array. As a result, the undershoot may be very large in the DLDO. To solve this problem, \cite{AALOOP} proposed the analog-assisted loop. The working principle is clear, as is shown in Fig\ref{fig:aaloop}b, if we can feedback the undershoot to the gate of the array unit, the unit can be at the half-open state before the clock arrive, so the undershoot is greatly reduced. To realize it, an RC loop connect the output and the ground of the inverter buffer as is shown in \ref{fig:latch}. So whenever an undershoot occurs, the buffer can sense it and tranfer it to the array instantly.

However, the passive devices like capacitors and resisters consume lots of area, so if we can share the analog-assisted loop, the area efficiency can be further increased.

//Introduction
Power management circuit needs multiple power domains.
DLDO becomes a trend.
The control circuit becomes more and more complicated in the state-of-art designs, and it takes up too much area.

To improve the area efficiency, a time-division-multiplexing (TDM) scheme has been applied in many other circuit designs and has achieved great success. In the following parts of this paper, we will discuss the TDM scheme in other circuit designs and how does it can be applied in DLDO design in section II, and  in section III, we will talk about the architecture and working principles of the proposed design. Then in section IV, the implementation and design considerations of the circuit will be discussed. And in section V, we present the experiment results of the proposed design, and finally we draw a conclusion in section VI.

To improve chip area efficiency, a time-division-multiplexing (TDM) scheme has been applied in many other circuits and has achieved great success. 

The remainder of this paper is organized as follow. In section II, we discuss the TDM scheme in other circuit, and address a method to apply it to DLDO. In section III, we present the architecture and working principles of the proposed DLDO design. In section IV, we interpret the circuit implementation and design considerations. In section V, we show the measurement results along with comparisons. In section VI, we conclude our proposed design.

In today's System on Chip (SoC) design, it usually requires multiple power domains to obtain the maximum energy efficiency for different application demands \cite{original,AALDO,AALDO1,coarse-fine,pipeline,asynchrounous,recursive}. To get a highly-efficient, highly-accurate power domain, the most popular choice is to apply the hierarchical power managing network. A basic hierarchical power managing network is depicted in Fig.\ref{}. Firstly, the DC-DC buck converters scale down the battery voltage to the operating voltage of the application with high efficiency. Then a post regulator, most frequently a low dropout regulator (LDO), is connected with the DC-DC to reduce the output voltage ripple. Finally, the fine-grained voltage is supplied for different function units such as RFs, AD/DAC, I/Os in the circuit.


Traditionally, the LDOs are implemented with an error amplifier, power stage, feedback and other analog transient enhancement subcircuits to provide a highly-accurate supply\cite{ALDO1,ALDO2,ALDO3}. However, the analog LDO design become harder and harder with the SoC operating voltage scaling down, and the Digital LDO(DLDO) draw significant attention in recent years for its low voltage operation capability and process scalability. Fig shows the original DLDO design proposed in\cite{original}. It consists of a clocked comparator, a bidirectional shift register, and a MOS array. When the output is below the reference, the shift register turn on a PMOS per clock, and vice versa. However, the original DLDO suffer from large drop voltage and ripple. Many advanced techniques proposed in \cite{AALDO, pipeline, coarse-fine, eventDriven, recursive} to handle these problems. In\cite{coarse-fine}, two MOS arrays with different size are employed. In steady state, the small MOS array is connected to the loop, and it switches to the large MOS array when the load changes. As a result, a relatively small drop voltage and ripple is realized simultaneously. In \cite{AALDO}, an additional analog assisted loop is added to further reduce the drop voltage. \cite{pipeline} apply a pipeline control but greatly increase the design complexity. In this paper, we adopt the design in \cite{AALDO} and \cite{coarse-fine} and realize a drop voltage around 100mV.

Traditionally, the LDOs are analog circuits which are implemented with error amplifiers and power stages. However, with the SoC supply voltage constantly scaling down, it becomes harder and harder for the amplifiers to meet the performance requirements. And LDO implemented with digital logics, or DLDO, draws great attention in academic recently. The DLDO was first proposed in \cite{original}. It consists of a clocked comparator, a bidirectional shift register and a PMOS array. The comparator compares the output with the reference. When the output is below the reference, the shift register shift right and turn on a unit of the PMOS array at every clock rising edge or vice versa. When the current provided by the PMOS array meet the load current, the output is regulated to the around of the reference.

The performances of the original DLDO are very poor, and many control techniques have been proposed to address this problem. In\cite{coarse-fine}, two PMOS arrays with different sizes are employed.

Although all these techniques are effective in some way, with the control circuit becoming more and more complicated, the area took up by the control circuit become equivalent and even greater than the power stage. So it becomes a very interesting topic how we can improve the area efficiency of the control circuit. To improve chip area efficiency, the time-division-multiplexing (TDM) scheme has been applied in many other circuits and has achieved great success. As is a digital concept, this scheme should be available to the DLDO design as well.

//comment AAloop
In \cite{AALDO,NANDbasedAAloop}, an analog-assisted (AA) loop composing of coupling capacitor and resistor is added. The AA loop sense the output undershoot and feed it back to the buffer of the PMOS array. Consequently, the PMOS array can response to the output before the clock rising edge, so greatly reduce the undershoot.

//comment pipeline
In \cite{}, it adopts a pipeline control structure and a 3-D power stage to realize the multi-step switching scheme. As a result it speeds up the transient response while maintaining a small output voltage ripple.

//comment recursive
In \cite{}, it proposed a recursive DLDO which improves the performances by applying a SAR-like binary search algorithm and a sub-LSB pulse width modulation duty control scheme. 

//shared AA loop
Nevertheless, if the capacitor or the resistor is too large, the time constant becomes a relatively large value, and may bring about cross-channel coupling between paths. So there is a tradeoff between cross-channel coupling and undershoot.

However, the on-chip capacitors and resisters consume lots of area, but AA loop only takes effect when the load changes, in other word, it stay idle at most of the time. So if we can share the AA loop between different paths, the area efficiency can be further increased. Fig.\ref{sharedAAloop} shows the working principle of the shared AA loop.  

The high pass network senses the undershoot at the confluent output and transfers it to the $V_{SSB}$ node. 
The multiplexers connected to latch groups are controlled by the "path" signal. If one path is selected, the multiplexer connects $V_{SSB}$ to the corresponding latch group and another multiplexer connect GND to the other latch group. So the shared AA loop only take effects on the active path, thus greatly improves the usage efficiency.

//Maximum regulated outputs
The basic DLDO operates as follow: when load change happens, the DLDO alternate its PMOS array to accommodate load requirements. 

In a stable system, the load of the LDO changes at a regular frequency, we can define the load change period as $\rm T_{load}$. Considering the best case that load change happens right after the ``sele'' signal falls down. We can define the response time of the DLDO as $\rm T_{response}$, then the maximum number of regulated output paths of the TDM DLDO is determined by $\rm T_{load}$, the duration of the ``sele'' signal $\rm T_{sele}$ and the response time $\rm T_{response}$.

The maximum number of regulated output paths of the TDM DLDO is determined by $T_{load}$, the duration of the ``sele'' signal $T_{sele}$ and the maximum response time of the DLDO when the load changes $T_{response}$. 

When the output reaches the nearby of the reference, either turning on or off one PMOS array unit may change the comparison result and limit cycle oscillation (LCO) occurs. In other word, the DLDO only regulate the output at the switching status, and disconnect the PMOS array from the shift register at the stable status may even be beneficial to the performance.

The response time of the DLDO is determined by the size of the PMOS array unit, the extent of load variation and clock frequency. Generally a larger PMOS array, smaller load variation and faster clock frequency may reduce the response time. However, larger PMOS array may lead to larger output ripple and a faster clock frequency may increase the dynamic power consumption. The influence of duration of the ``sele'' signal will discussed later. Normally, the response time $\rm T_{response}$ is on the order of tens of clock period.

//Comparator and D-type flip flop
Comparator and D-type flip flop are two core circuits in the DLDO design. Comparators are usually sense amplifier based dynamic comparator. The schematic that adopted in our paper is shown in Fig.\ref{fig:comp}. It has two stages, namely pre-amplify stage and regenerate stage. When the clock is low, M4 and M7\~9 turns on, so both "out+" and "out-" is low. And when the clock switches to high, M8\~9 turns off and M12 turns on, so the pre-amplifier stage amplify the difference at the input nodes. The M1 turns on as well, so the output of the pre-amplifier stage determines the charge speed at "out+" and "out-". Once one of the nodes reaches the threshold voltage, the regenerate stage forms a positive feedback, and this node become high, the other node become low. D-type flip flop is another structure which plays an important role in the DLDO design, however, the D-type flip flop structure is hardly mentioned in the literature. The D-type flip flop adopted in our design is also a sense amplifier based structure as is shown in Fig.\ref{fig:DFF}, and the working principle of it is similar to the dynamic comparator.  

To obtain faster recovery time during the load transform period, the size of the power PMOS array, i.e., W/L, need to be large. However, the larger power PMOS array often leads to a degraded resolution, more specifically,  bigger ripple due to the limited cycle oscillation(LCO) will arise during the steady period. To get a balance between speed and resolution, coarse-fine switching technique is applied\cite{coarse-fine}. In each power PMOS array, there are two groups power PMOS with different sizes, which are controlled by different shift register and clock. During the transform period, the larger power PMOS group and its corresponding shift register and clock are activated, meanwhile the smaller counterpart keep unchanged. Because the larger power PMOS can provide N times current than that of the smaller one, the recovery time from undershoot or overshoot can be greatly reduced. Once the output voltage meet the up or down boundary, the shift register for the larger power PMOS is deactivated, and the smaller power PMOS and its matched control circuit begin to operate. Consequently, the LDO can provide a more accurate output.
In shift register based DLDO, there is always a trade off between accuracy and speed. To obtain a faster transient response, the size of the power PMOS array units need to be large. However, a larger units may bring about larger ripple when the output settles and one unit toggles between ON and OFF. If we choose a smaller PMOS array unit, the output ripple may be small, but there needs to be much more clock periods to settle, so the transient response may be poor. To solve this problem, many existing topologies have adopted the coarse-fine switching techniques\cite{}. The coarse-fine switching controller applied in our design is shown in Fig.\ref{}, 